<!doctype html>
<html lang="de">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Wählergemeinschaft Rottershausen</title>
  <meta name="description" content="Wählergemeinschaft Rottershausen – Kandidatinnen und Kandidaten zur Gemeinderatswahl." />

  <!-- Flyer-Schrift -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet">

  <link rel="stylesheet" href="styles.css" />
</head>

<body>
  <!-- HERO (Flyer Seite 1 als Startscreen) -->
  <header class="hero" id="top">
    <div class="container heroGrid">
      <div class="heroLeft">
        <div class="heroDate">
          <div class="heroDateBig">8.03.</div>
          <div class="heroDateBig">2026</div>
        </div>

        <div class="heroHead">
          <h1>Wahltag.<br>Ihre Stimme für Rottershausen.</h1>
          <p class="heroIntro">
            Sie haben die Möglichkeit, neben dem Landrat und Kreistag auch den neuen
            <strong>Gemeinderat</strong> und den <strong>Bürgermeister</strong> zu wählen.
          </p>
        </div>

        <ul class="heroBullets">
          <li>
            <span class="bulletIcon" aria-hidden="true">✕</span>
            <span>Sie entscheiden über die Zukunft unserer Gemeinde in den kommenden 6 Jahren.</span>
          </li>
          <li>
            <span class="bulletIcon" aria-hidden="true">✕</span>
            <span>Ihre Stimme ist wichtig, denn nur mit Ihrer Hilfe können wir unseren Ort &amp; kleinsten Gemeindeteil angemessen vertreten.</span>
          </li>
          <li>
            <span class="bulletIcon" aria-hidden="true">✕</span>
            <span>Ihre Stimme trägt bei zu einer verlässlichen, unabhängigen und verantwortungsbewussten Gemeindepolitik.</span>
          </li>
        </ul>
      </div>

      <div class="heroRight" aria-hidden="true">
        <!-- Spirk-Illustration -->
        <img class="spirk" src="assets/spirk.svg" alt="">
      </div>
    </div>

    <!-- Rotes Band -->
    <div class="heroBand">
      <div class="container heroBandInner">
        <div class="bandTitle">Wählergemeinschaft<br>Rottershausen</div>
        <div class="bandSub">Wir Rottershäuserinnen und Rottershäuser müssen zusammenhalten!</div>
      </div>
    </div>
  </header>

  <main class="container">
    <!-- Kandidaten-Bereich -->
    <section class="section" id="kandidaten">
      <div class="sectionHead">
        <h2>Für Rottershausen in den Gemeinderat</h2>
        <p class="sectionLead">
          Für weitere Informationen zu den Kandidatinnen und Kandidaten klicken Sie auf <strong>Details anzeigen</strong>.
          (Freiwillige angaben).
        </p>
      </div>

      <div id="grid" class="grid" aria-label="Kandidat:innen"></div>
    </section>

    <!-- UNTERER FLYER-TEIL (alles nach dem letzten Kandidaten, Flyer Seite 2) -->
    <section class="section bottomFlyer" id="wahlhinweise" aria-label="Wahlhinweise und Wahlvorschlag">
      <div class="bottomGrid">
        <!-- Linker Block: Wahlhinweise -->
        <article class="infoCard">
          <h3>So wählen Sie</h3>
          <p>
            Jede Wählerin und jeder Wähler hat <strong>20 Stimmen</strong> für die Gemeinderatswahl zur Verfügung.
          </p>
          <p>
            Mit dem Kreuz ganz oben für die <strong>Wählergemeinschaft Rottershausen</strong> erhält
            jede Kandidatin und jeder Kandidat eine Stimme – die ersten fünf, die doppelt aufgeführt sind,
            erhalten jeweils zwei Stimmen.
          </p>
          <p>
            Sie können Ihre 20 Stimmen aber auch individuell verteilen. Dabei können Sie jeder Kandidatin bzw.
            jedem Kandidaten <strong>maximal drei Stimmen</strong> geben – auch den doppelt aufgeführten.
            Tragen Sie dazu die Zahl <strong>1</strong>, <strong>2</strong> oder <strong>3</strong> in das Kästchen neben dem Namen ein.
          </p>
          <p class="warning">
            <strong>Achtung:</strong> Sie dürfen insgesamt nicht mehr als <strong>20 Stimmen</strong> vergeben!
          </p>
          <p class="moreInfo">
            Weitere Informationen zu unseren Kandidatinnen und Kandidaten finden Sie hier:<br>
            <a href="https://waehlergemeinschaft-rottershausen.de" rel="noopener">waehlergemeinschaft-rottershausen.de</a>
          </p>
        </article>

        <!-- Rechter Block: Bürgermeister-Unterstützung + Wahlzettel-Kasten -->
        <aside class="asideStack">
          <article class="supportCard">
            <div class="supportText">
              <p>
                Bitte unterstützen Sie auch <strong>Nico Rogge</strong>, der in diesem Jahr erneut zur Wahl
                des ersten Bürgermeisters antritt, mit Ihrer Stimme.
             
                  <span></span><span></span><span></span><span></span>
                </div>
              </div>
            </div>
          </article>
        </aside>
      </div>
    </section>
  </main>

  <footer class="footer">
    <div class="container footerInner">
      <span>© <span id="year"></span> Wählergemeinschaft Rottershausen</span>
      <span class="sep">·</span>
      <a href="#top">Nach oben</a>
      <span class="sep">·</span>
      <a href="impressum.html">Impressum</a>
      <span class="sep">·</span>
      <a href="datenschutz.html">Datenschutz</a>
    </div>
  </footer>

  <script>
    document.getElementById("year").textContent = String(new Date().getFullYear());

    function escapeHTML(input) {
      return String(input ?? "")
        .replaceAll("&", "&amp;")
        .replaceAll("<", "&lt;")
        .replaceAll(">", "&gt;")
        .replaceAll('"', "&quot;")
        .replaceAll("'", "&#039;");
    }

    function nl2brSafe(input) {
      return escapeHTML(input).replaceAll("\n", "<br>");
    }

    function hasDetails(c) {
      return Boolean(c.alter || (Array.isArray(c.fokusthemen) && c.fokusthemen.length) || c.ueberMich);
    }

    async function loadCandidates() {
      const grid = document.getElementById("grid");

      try {
        const res = await fetch("candidates.json", { cache: "no-store" });
        if (!res.ok) throw new Error("candidates.json nicht gefunden");
        const data = await res.json();

        const sorted = (Array.isArray(data) ? data : [])
          .slice()
          .sort((a, b) => (a.sortKey ?? 9999) - (b.sortKey ?? 9999));

        grid.innerHTML = sorted.map(c => {
          // Sonderfall: Platz 15 -> nur Hinweistext
          if (c.restricted === true) {
            return `
              <article class="card restricted">
                <div class="slotPill">Listenplatz ${escapeHTML(c.listenplatz)}</div>
                <div class="restrictedText">Namentliche Nennung nicht erlaubt</div>
              </article>
            `;
          }

          const listenplatz = escapeHTML(c.listenplatz);
          const name = escapeHTML(c.name);
          const beruf = escapeHTML(c.beruf);
          const photo = escapeHTML(c.photo);

          const ageHTML = c.alter ? `<p class="line"><strong>Alter:</strong> ${escapeHTML(c.alter)}</p>` : "";

          const themen = Array.isArray(c.fokusthemen) ? c.fokusthemen : [];
          const tagsHTML = themen.length ? `
            <div class="block">
              <div class="label">Fokusthemen</div>
              <div class="tags">
                ${themen.map(t => `<span class="tag">${escapeHTML(t)}</span>`).join("")}
              </div>
            </div>
          ` : "";

          const aboutHTML = c.ueberMich ? `
            <div class="block">
              <div class="label">Über mich</div>
              <p class="about">${nl2brSafe(c.ueberMich)}</p>
            </div>
          ` : "";

          const detailsHTML = hasDetails(c) ? `
            <details class="details">
              <summary>Details anzeigen</summary>
              <div class="detailsInner">
                ${ageHTML}
                ${tagsHTML}
                ${aboutHTML}
              </div>
            </details>
          ` : "";

          return `
            <article class="card">
              <div class="photoWrap">
                <img class="avatar" src="${photo}" alt="Foto von ${name}" loading="lazy">
              </div>

              <div class="cardBody">
                <div class="slotPill">Listenplatz ${listenplatz}</div>
                <h3 class="name">${name}</h3>
                <p class="job">${beruf}</p>
                ${detailsHTML}
              </div>
            </article>
          `;
        }).join("");

      } catch (err) {
        grid.innerHTML = `
          <div class="errorBox">
            <strong>Fehler:</strong> Kandidaten konnten nicht geladen werden.<br>
            Prüfe, ob <code>candidates.json</code> im Repo liegt und gültig ist.
          </div>
        `;
        console.error(err);
      }
    }

    loadCandidates();
  </script>
</body>
</html>
