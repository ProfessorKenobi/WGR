<!doctype html>
<html lang="de">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Wählergemeinschaft Rottershausen</title>
  <meta name="description" content="Wählergemeinschaft Rottershausen – Kandidatinnen und Kandidaten zur Gemeinderatswahl." />
  <link rel="stylesheet" href="styles.css" />
</head>

<body>
  <!-- HERO -->
  <header class="hero" id="top">
    <div class="container heroGrid">
      <div class="heroLeft">
        <div class="heroDate">
          <div class="heroDateBig">8.03.</div>
          <div class="heroDateBig">2026</div>
        </div>

        <div class="heroHead">
          <h1>Wahltag.<br>Ihre Stimme für Rottershausen.</h1>
          <p class="heroIntro">
            Sie haben die Möglichkeit, neben dem Landrat und Kreistag auch den neuen
            <strong>Gemeinderat</strong> und den <strong>Bürgermeister</strong> zu wählen.
          </p>
        </div>

        <ul class="heroBullets">
          <li>
            <span class="bulletIcon" aria-hidden="true">✕</span>
            <span>Sie entscheiden über die Zukunft unserer Gemeinde in den kommenden 6 Jahren.</span>
          </li>
          <li>
            <span class="bulletIcon" aria-hidden="true">✕</span>
            <span>Ihre Stimme ist wichtig, denn nur mit Ihrer Hilfe können wir unseren Ort &amp; kleinsten Gemeindeteil angemessen vertreten.</span>
          </li>
          <li>
            <span class="bulletIcon" aria-hidden="true">✕</span>
            <span>Ihre Stimme trägt bei zu einer verlässlichen, unabhängigen und verantwortungsbewussten Gemeindepolitik.</span>
          </li>
        </ul>
      </div>

      <div class="heroRight" aria-hidden="true">
        <img class="spirk" src="assets/spirk.svg" alt="">
      </div>
    </div>

    <div class="heroBand">
      <div class="container heroBandInner">
        <div class="bandTitle">Wählergemeinschaft<br>Rottershausen</div>
        <div class="bandSub">Wir Rottershäuserinnen und Rottershäuser müssen zusammenhalten!</div>
      </div>
    </div>
  </header>

  <main class="container">
    <!-- Kandidaten -->
    <section class="section" id="kandidaten">
      <div class="sectionHead">
        <h2>Für Rottershausen in den Gemeinderat</h2>
        <p class="sectionLead">
          Für weitere Informationen zu den Kandidatinnen und Kandidaten klicken Sie auf <strong>Details anzeigen</strong>.
          <span class="fineNote">(Freiwillige Angaben)</span>
        </p>
      </div>

      <div id="grid" class="grid" aria-label="Kandidat:innen"></div>
    </section>

    <!-- Unterer Teil -->
    <section class="section bottomFlyer" id="wahlhinweise" aria-label="Wahlhinweise und Bürgermeister">
      <div class="bottomGrid">
        <article class="infoCard">
          <h3>So wählen Sie</h3>

          <p>Jede Wählerin und jeder Wähler hat <strong>20 Stimmen</strong> für die Gemeinderatswahl zur Verfügung.</p>

          <p>
            Mit dem Kreuz ganz oben für die <strong>Wählergemeinschaft Rottershausen</strong> erhält
            jede Kandidatin und jeder Kandidat eine Stimme – die ersten fünf, die doppelt aufgeführt sind,
            erhalten jeweils zwei Stimmen.
          </p>

          <p>
            Sie können Ihre 20 Stimmen aber auch individuell verteilen. Dabei können Sie jeder Kandidatin bzw.
            jedem Kandidaten <strong>maximal drei Stimmen</strong> geben – auch den doppelt aufgeführten.
            Tragen Sie dazu die Zahl <strong>1</strong>, <strong>2</strong> oder <strong>3</strong> in das Kästchen neben dem Namen ein.
          </p>

          <p class="warning"><strong>Achtung:</strong> Sie dürfen insgesamt nicht mehr als <strong>20 Stimmen</strong> vergeben!</p>
        </article>

        <aside class="asideStack">
          <article class="supportCard" aria-label="Bürgermeister">
            <p>
              Bitte unterstützen Sie auch <strong>Nico Rogge</strong>, der in diesem Jahr erneut zur Wahl
              des ersten Bürgermeisters antritt, mit Ihrer Stimme.
            </p>

            <div class="personLine">
              <div class="avatarCircle" aria-hidden="true">
                <img src="img/nico.jpg" alt="" loading="lazy" onerror="this.remove();">
                <span class="initials">NR</span>
              </div>
              <div>
                <div class="personName">Nico Rogge</div>
                <div class="personRole">Erster Bürgermeister<br>Gemeinde Oerlenbach</div>
              </div>
            </div>
          </article>
        </aside>
      </div>
    </section>

    <!-- Wahlzettel (volle Breite) -->
    <section class="section" id="wahlzettel" aria-label="Wahlzettel">
      <figure class="ballotFigure">
        <img class="ballotImage" src="assets/wahlzettel.png" alt="Wahlzettel – Wahlvorschlag Nr. 08" loading="lazy">
      </figure>
    </section>
  </main>

  <footer class="footer">
    <div class="container footerInner">
      <div class="footerCol">
        <p class="footerP">© <span id="year"></span> Wählergemeinschaft Rottershausen</p>

        <p class="footerP">
          Fotografien und Design von Marlene Wetterich
          <a href="https://marlenewetterich.de" target="_blank" rel="noopener">marlenewetterich.de</a>
          bzw.
          <a href="http://marlene-photography.de" target="_blank" rel="noopener">marlene-photography.de</a>
        </p>

        <p class="footerP">
          Erstellung Website durch Matthäus Owczarek auf Basis des Designs von Marlene Wetterich
        </p>
      </div>

      <div class="footerLinks">
        <a href="#top">Nach oben</a>
        <span class="sep">·</span>
        <a href="impressum.html">Impressum</a>
        <span class="sep">·</span>
        <a href="datenschutz.html">Datenschutz</a>
      </div>
    </div>
  </footer>

  <script>
    document.getElementById("year").textContent = String(new Date().getFullYear());

    function escapeHTML(input) {
      return String(input ?? "")
        .replaceAll("&", "&amp;")
        .replaceAll("<", "&lt;")
        .replaceAll(">", "&gt;")
        .replaceAll('"', "&quot;")
        .replaceAll("'", "&#039;");
    }

    function nl2brSafe(input) {
      return escapeHTML(input).replaceAll("\n", "<br>");
    }

    function hasDetails(c) {
      return Boolean(
        c.alter ||
        (Array.isArray(c.fokusthemen) && c.fokusthemen.length) ||
        c.ueberMich
      );
    }

    async function loadCandidates() {
      const grid = document.getElementById("grid");

      try {
        const res = await fetch("candidates.json", { cache: "no-store" });
        if (!res.ok) throw new Error("candidates.json nicht gefunden");
        const data = await res.json();

        const sorted = (Array.isArray(data) ? data : [])
          .slice()
          .sort((a, b) => (a.sortKey ?? 9999) - (b.sortKey ?? 9999));

        grid.innerHTML = sorted.map(c => {
          const listenplatz = escapeHTML(c.listenplatz);

          if (c.restricted === true) {
            const photo = escapeHTML(c.photo || "");
            return `
              <article class="card restrictedCard">
                <div class="photoWrap">
                  ${photo ? `<img class="avatar" src="${photo}" alt="" loading="lazy">` : ""}
                </div>
                <div class="cardBody">
                  <div class="slotPill">Listenplatz ${listenplatz}</div>
                  <p class="restrictedText">Namentliche Nennung nicht erlaubt</p>
                </div>
              </article>
            `;
          }

          const name = escapeHTML(c.name);
          const beruf = escapeHTML(c.beruf);
          const photo = escapeHTML(c.photo);

          const ageHTML = c.alter
            ? `<p class="line"><strong>Alter:</strong> ${escapeHTML(c.alter)}</p>`
            : "";

          const themen = Array.isArray(c.fokusthemen) ? c.fokusthemen : [];
          const tagsHTML = themen.length ? `
            <div class="block">
              <div class="label">Fokusthemen</div>
              <div class="tags">
                ${themen.map(t => `<span class="tag">${escapeHTML(t)}</span>`).join("")}
              </div>
            </div>
          ` : "";

          const aboutHTML = c.ueberMich ? `
            <div class="block">
              <div class="label">Über mich</div>
              <p class="about">${nl2brSafe(c.ueberMich)}</p>
            </div>
          ` : "";

          const detailsHTML = hasDetails(c) ? `
            <details class="details">
              <summary>Details anzeigen</summary>
              <div class="detailsInner">
                ${ageHTML}
                ${tagsHTML}
                ${aboutHTML}
              </div>
            </details>
          ` : "";

          return `
            <article class="card">
              <div class="photoWrap">
                <img class="avatar" src="${photo}" alt="Foto von ${name}" loading="lazy">
              </div>

              <div class="cardBody">
                <div class="slotPill">Listenplatz ${listenplatz}</div>
                <h3 class="name">${name}</h3>
                <p class="job">${beruf}</p>
                ${detailsHTML}
              </div>
            </article>
          `;
        }).join("");

      } catch (err) {
        grid.innerHTML = `
          <div class="errorBox">
            <strong>Fehler:</strong> Kandidaten konnten nicht geladen werden.<br>
            Prüfe, ob <code>candidates.json</code> im Repo liegt und gültig ist.
          </div>
        `;
        console.error(err);
      }
    }

    loadCandidates();
  </script>
</body>
</html>
